# Ubuntu

The [Cartesi](http://cartesi.io) team is interested in having node images built for `linux/riscv64` architecture, so it can be used as a base image for Cartesi DApps written in nodejs.

Debian and buildpack-deps debian images, which are the base for the official node image, are still unstable for `linux/riscv64` platform.

On the other hand Ubuntu and buildpack-deps ubuntu images already have official builds for `linux/riscv64`.

So this branch adds Ubuntu based variants for the `node` image.
A [PR was opened upstream](https://github.com/nodejs/docker-node/pull/1834), but it was closed.

In the meantime the Cartesi team is building the image and publishing as `cartesi/node`.

```shell
docker pull cartesi/node
```

## Building locally

The primary change introduced in this branch was to `versions.json`, adding `jammy` and `noble` variants. The other changes are generated by executing the following command, which uses Docker so it works on any platform.

```shell
docker run -it --rm -v $(pwd):/app ubuntu
apt-get update && apt-get install -y curl && cd /app && ./update.sh
```

After running the command above the Dockerfiles for the target architecture of the host/docker machine are created or updated. So if `linux/riscv64` architecture is desired, specify `--platform linux/riscv64` to `docker run`.

The commands below build the images locally, using `dockerx` multi platform build.

```shell
docker buildx bake
```

> TODO: create a script to generate the [docker-bake.hcl](docker-bake.hcl) file from the [versions.json](versions.json) files.

Several tags are built, the main one is `docker.io/cartesi/node:noble`.
